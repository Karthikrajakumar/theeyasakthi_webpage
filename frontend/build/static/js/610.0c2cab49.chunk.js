"use strict";(self.webpackChunktheeyasakthi_webpage=self.webpackChunktheeyasakthi_webpage||[]).push([[610],{362(e,t,o){o.r(t),o.d(t,{default:()=>p});var s=o(29),l=o(555),i=o(43),n=o(472),a=o(968),c=o(579);async function d(){var e,t,o,s,l,i;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;const a="AIzaSyBcDen3i7LkL88D7RRPzRvvGxSCVKcSTKc",c="UCReZMtVP4QYpV9PwfR50dHg";const d=await fetch("https://www.googleapis.com/youtube/v3/channels?part=contentDetails&id=".concat(c,"&key=").concat(a)),r=null===(e=(await d.json()).items)||void 0===e||null===(t=e[0])||void 0===t||null===(o=t.contentDetails)||void 0===o||null===(s=o.relatedPlaylists)||void 0===s?void 0:s.uploads;if(!r)return{shorts:[],videos:[]};const u=await fetch("https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&playlistId=".concat(r,"&maxResults=").concat(n,"&key=").concat(a)),h=(null===(l=(await u.json()).items)||void 0===l?void 0:l.map(e=>{var t,o;return null===(t=e.snippet)||void 0===t||null===(o=t.resourceId)||void 0===o?void 0:o.videoId}).filter(Boolean))||[];if(!h.length)return{shorts:[],videos:[]};const v=await fetch("https://www.googleapis.com/youtube/v3/videos?part=contentDetails,snippet&id=".concat(h.join(","),"&key=").concat(a)),m=await v.json(),p=[],g=[];return null===(i=m.items)||void 0===i||i.forEach(e=>{var t,o,s,l,i,n,a,c,d,r,u,h,v,m,b,f,y,j;const w=(e=>{var t,o,s;if(!e)return null;const l=3600*parseInt((null===(t=e.match(/(\d+)H/))||void 0===t?void 0:t[1])||0,10)+60*parseInt((null===(o=e.match(/(\d+)M/))||void 0===o?void 0:o[1])||0,10)+parseInt((null===(s=e.match(/(\d+)S/))||void 0===s?void 0:s[1])||0,10);return Number.isFinite(l)?l:null})(null===(t=e.contentDetails)||void 0===t?void 0:t.duration),x="number"===typeof w&&w<90,I={id:e.id,videoId:e.id,title:(null===(o=e.snippet)||void 0===o?void 0:o.title)||"",thumbnail:(null===(s=e.snippet)||void 0===s||null===(l=s.thumbnails)||void 0===l||null===(i=l.maxres)||void 0===i?void 0:i.url)||(null===(n=e.snippet)||void 0===n||null===(a=n.thumbnails)||void 0===a||null===(c=a.standard)||void 0===c?void 0:c.url)||(null===(d=e.snippet)||void 0===d||null===(r=d.thumbnails)||void 0===r||null===(u=r.high)||void 0===u?void 0:u.url)||(null===(h=e.snippet)||void 0===h||null===(v=h.thumbnails)||void 0===v||null===(m=v.medium)||void 0===m?void 0:m.url)||(null===(b=e.snippet)||void 0===b||null===(f=b.thumbnails)||void 0===f||null===(y=f.default)||void 0===y?void 0:y.url),publishedAt:null===(j=e.snippet)||void 0===j?void 0:j.publishedAt,durationSeconds:w,isShort:x,type:x?"short":"video"};x?p.push(I):g.push(I)}),{shorts:p,videos:g}}function r(e){let{title:t,items:o,loading:l,emptyMessage:n}=e;const[a,d]=(0,i.useState)(1),[r,u]=(0,i.useState)(".6s");(0,i.useEffect)(()=>{o.length>0&&d(1)},[o]);const h=(0,i.useCallback)(()=>{d(e=>e+1)},[]),v=(0,i.useCallback)(()=>{d(e=>e-1)},[]);(0,i.useEffect)(()=>{if(o.length<2)return;const e=setInterval(h,4500);return()=>clearInterval(e)},[h,o.length]),(0,i.useEffect)(()=>{if(o.length<2)return;const e=o.length+2;a===e-1&&setTimeout(()=>{u("0s"),d(1),setTimeout(()=>u(".6s"),20)},600),0===a&&setTimeout(()=>{u("0s"),d(e-2),setTimeout(()=>u(".6s"),20)},600)},[a,o.length]);const m=(e=>e.length>0?[e[e.length-1],...e,e[0]]:[])(o),p=o.length<2;return console.log('\ud83c\udfac CarouselBlock "'.concat(t,'":'),{loading:l,itemsCount:o.length,slidesCount:m.length,index:a,items:o,slides:m}),(0,c.jsxs)("section",{className:"carousel-section",children:[(0,c.jsx)("div",{className:"carousel-header",children:(0,c.jsx)("h2",{className:"carousel-title",children:t})}),l?(0,c.jsx)("p",{className:"carousel-msg",children:"Loading videos\u2026"}):0===o.length?(0,c.jsx)("p",{className:"carousel-msg",children:n}):(0,c.jsxs)("div",{className:"simple-carousel",children:[(0,c.jsx)("button",{className:"nav left",onClick:v,disabled:p,children:"\u276e"}),(0,c.jsx)("div",{className:"track-wrapper",children:(0,c.jsx)("div",{className:"track",style:{transform:"translateX(-".concat(100*a,"%)"),transition:r},children:m.map((e,t)=>(console.log("\ud83d\uddbc\ufe0f Rendering slide ".concat(t,":"),{videoId:e.videoId,thumbnail:e.thumbnail,title:e.title}),(0,c.jsx)("div",{className:"slide",children:(0,c.jsxs)(s.N_,{to:"/youtube/".concat(e.videoId),className:"thumb-link",children:[(0,c.jsx)("img",{src:e.thumbnail,alt:e.title||"Video thumbnail",className:"thumb-img",onLoad:()=>console.log("\u2705 Image loaded: ".concat(e.videoId)),onError:t=>{console.error("\u274c Image failed to load: ".concat(e.videoId),e.thumbnail),t.target.src="https://img.youtube.com/vi/".concat(e.videoId,"/hqdefault.jpg")}}),(0,c.jsx)("span",{className:"play-overlay",children:"\u25b6"})]})},"".concat(e.id||e.videoId,"-").concat(t))))})}),(0,c.jsx)("button",{className:"nav right",onClick:h,disabled:p,children:"\u276f"})]})]})}function u(){const[e,t]=(0,i.useState)([]),[o,s]=(0,i.useState)([]),[u,h]=(0,i.useState)(!0),[v,m]=(0,i.useState)("");return(0,i.useEffect)(()=>{(async()=>{try{let o;h(!0),m(""),console.log("\ud83d\udd25 VideoCarousel: Starting fetch..."),console.log("\ud83d\udd25 Firebase DB instance:",a.db);try{console.log("\ud83d\udd25 Attempting ordered query...");const e=(0,n.P)((0,n.rJ)(a.db,"videos"),(0,n.My)("publishedAt","desc"),(0,n.AB)(18));o=await(0,n.GG)(e),console.log("\u2705 Ordered query succeeded, docs:",o.docs.length)}catch(e){console.warn("\u26a0\ufe0f Ordered query failed, falling back to unordered fetch",e),o=await(0,n.GG)((0,n.rJ)(a.db,"videos")),console.log("\u2705 Unordered fetch succeeded, docs:",o.docs.length)}console.log("\ud83d\udcca Raw Firestore docs:",o.docs.length);const i=o.docs.map(e=>{const t=e.data();console.log("\ud83d\udcc4 Document:",e.id,t);const o=t.videoId?"https://img.youtube.com/vi/".concat(t.videoId,"/hqdefault.jpg"):"";return(0,l.A)((0,l.A)({id:e.id},t),{},{thumbnail:t.thumbnail||o})}).filter(e=>{const t=Boolean(e.videoId);return console.log("\ud83d\udd0d Video ".concat(e.id," has videoId:"),t,e.videoId),t});console.log("\u2705 Filtered data (with videoId):",i.length,i);const c=e=>{if(!e)return 0;if("function"===typeof e.toMillis)return e.toMillis();if(e.seconds)return 1e3*e.seconds+(e.nanoseconds||0)/1e6;const t=Date.parse(e);return Number.isFinite(t)?t:0},r=i.slice().sort((e,t)=>c(t.publishedAt||t.createdAt)-c(e.publishedAt||e.createdAt)).slice(0,18);console.log("\u2705 Sorted data:",r.length);const u=[],v=[];r.forEach(e=>{const t=(e.type||"").toLowerCase(),o=!0===e.isShort,s="number"===typeof e.durationSeconds?e.durationSeconds:null,l=o||"short"===t||"shorts"===t||null!==s&&s>0&&s<60,i="video"===t&&!o||null!==s&&s>=90||null===s&&!1===e.isShort&&"short"!==t&&"shorts"!==t;l?u.push(e):i&&v.push(e)}),console.log("\u2705 FINAL RESULTS:",{totalFromFirestore:i.length,afterSort:r.length,shortsCount:u.length,videosCount:v.length,shortsData:u.map(e=>({id:e.videoId,title:e.title,type:e.type,dur:e.durationSeconds})),videosData:v.map(e=>({id:e.videoId,title:e.title,type:e.type,dur:e.durationSeconds}))}),t(u.slice(0,3)),s(v.slice(0,3));if(0===u.length&&0===v.length){console.log("\u26a0\ufe0f No data from Firestore, trying YouTube API fallback...");const e=await d(6);console.log("\u2705 YouTube fallback result:",e),(e.shorts.length||e.videos.length)&&(t(e.shorts.slice(0,3)),s(e.videos.slice(0,3)))}}catch(o){console.error("\u274c Failed to load videos",o);try{console.log("\u26a0\ufe0f Trying YouTube API fallback due to error...");const e=await d(6);t(e.shorts.slice(0,3)),s(e.videos.slice(0,3)),m("Firestore fetch failed; showing YouTube fallback")}catch(i){console.error("\u274c YouTube fallback failed",i),t([]),s([]),m("Unable to load videos from Firestore or YouTube. Check API key/Channel ID and network.")}}finally{h(!1),console.log("\ud83c\udfc1 VideoCarousel fetch complete")}})()},[]),(0,c.jsxs)("div",{className:"about-subtitle",children:[(0,c.jsx)(r,{title:"Latest Videos",items:o,loading:u,emptyMessage:"No videos available."}),(0,c.jsx)(r,{title:"Latest Shorts",items:e,loading:u,emptyMessage:"No shorts available."}),v&&(0,c.jsx)("p",{className:"carousel-msg",style:{color:"#fca5a5"},children:v})]})}const h=o.p+"static/media/hero.e2e432c04294ccc1c8fa.jpg",v=o.p+"static/media/bg_pic.be5b3b546179dc146639.jpg";var m=o(559);function p(){return(0,c.jsx)(m.A,{children:(0,c.jsxs)("div",{className:"home-bg",style:{backgroundImage:"url(".concat(v,")")},children:[(0,c.jsx)("section",{className:"hero-image",children:(0,c.jsx)("img",{src:h,alt:"Welcome to Theeyasakthi TN"})}),(0,c.jsxs)("section",{className:"intro-hero",children:[(0,c.jsx)("h1",{children:"Here you can enjoy politics in a sarcastic way."}),(0,c.jsx)("p",{children:"Welcome to Theeysakthi TN"})]}),(0,c.jsxs)("section",{className:"about-preview container",children:[(0,c.jsx)("h2",{className:"about-subtitle",children:"About Theeyasakthi"}),(0,c.jsx)("p",{style:{fontSize:"1.5rem",opacity:".9"},children:(0,c.jsx)("r",{children:"Discover the satire, stories, and spicy political takes behind our content. Learn why we do what we do \u2014 with humour, honesty, and a bold voice. "})}),(0,c.jsx)(s.N_,{to:"/about",className:"about-btn",children:"Read More"})]}),(0,c.jsx)(u,{})]})})}}}]);
//# sourceMappingURL=610.0c2cab49.chunk.js.map